# Mean first passage times of the symmetric noisy voter model

This repository contains code used to obtain numerical results reported in
[1]. The code is effectively split into three parts: numerical simulation
(all the `sim_*.py` and `run-sim-*.sh` files), data cleanup (all the
`clean-*.sh` files) and plotting (all the `fig*` files).

Numerical simulation is performed by numerically solving the symmetric noisy
voter model SDE:

$$ d x = \varepsilon \left( 1 - 2 x \right) d t + \sqrt{2 x (1-x)} d W .$$

This SDE corresponds to Eq. (2) from [1] with $h=1$ (timescale parameter may
be set to any value in general, it will trivial impact the first passage
times) and $\varepsilon_0=\varepsilon_1=\varepsilon$ (hence the symmetry in
the model).

Numerical solver of the SDE above is implemented in C (run `make-nvm_fpt.sh`
to compile it). Our code uses `ctypes` library to provide an interface with
Python. Solution uses Euler-Maruyama method (with default time step $\Delta
t=10^{-5}$).

To determine the mean first passage times $10^5$ samples were obtained. To
speed up the simulation, we reset the simulation to the initial condition
each time the threshold (absorbing boundary) is reached. Simulation is also
reset if no passage is detected for a very long time, $T_{max}=10^6$. In
this extremely rare case the first passage time is assumed to be equal to
$T_{max}$.

## Usage

*If you want to run the simulations*, you'll have to compile the C code in
`nvm_fpt/src` directory. This can be done running `make-nvm_fpt.sh` script
(though note that you need to have `make`, `gcc` and GNU Scientific Library
installed).

After compiling, you may run all the simulations by running
`run-all-sims.sh` script (it uses GNU parallel utility to distribute
workload between 24 cores; on a reasonably modern computer running
simulations, as configured, should take up to 48 hours). Or you may run the
individual batches:

* `*-sim-01-*` script runs simulations whose results are reported in Fig. 1.
  These simulations examine how the mean first passage time depends on the
  initial condition, when both boundary conditions are absorbing. Rates vary
  across multiple simulations.
* `*-sim-02-*` script runs simulations whose results are reported in Fig. 2.
  These simulations examine how the mean first passage time depends on the
  initial condition, when one of the boundary conditions is reflecting (the
  lower boundary) and the other is absorbing (the upper boundary). Rates
  vary across multiple simulations.
* `*-sim-11-*` script runs simulations whose results are reported in Fig. 3
  (a). These simulations show that as long as absorbing boundary conditions
  are symmetric, the maximum of the mean first passage time dependence on
  the initial condition remains close to $x_0 = 1/2$.
* `*-sim-12-*` script runs simulations whose results are reported in Fig. 3
  (b). These simulations show that for asymmetric absorbing boundary
  conditions, the maximum of the mean first passage time dependence on the
  initial condition shifts to the boundary condition close to the natural
  boundary condition.
* `*-sim-21-*` script runs simulations whose results are reported in Fig. 4.
  These simulations show the dependence of $ x_{0,\text{max}} $ (the initial
  condition for which the mean first passage time is largest) on the
  location of the boundary conditions.
* `*-sim-31-*` script runs simulations whose results are reported in Fig. 5
  (a). These simulations examine how the mean first passage time depends on
  the transition rate, while initial condition is fixed. Both boundary
  conditions are absorbing.
* `*-sim-32-*` script runs simulations whose results are reported in Fig. 5
  (b). These simulations examine how the mean first passage time depends on
  the transition rate, while initial condition is fixed. One boundary
  condition is reflecting, the other is absorbing.

Note that after running all simulations `run-all-sims.sh` script runs
`clean-all-data.sh` script, which cleans up (i.e., sorts relevant columns)
output of certain simulation.

*If you don't want to run the simulations*, you do not need to compile the
code. The data generated by simulation is stored in the `data` directory,
and it can be used to produce the figures without running the simulations
themselves.

Figures can be generated by running `fig.sh` script (which optionally
depends on `GhostScript` to optimize the output PDF files). Figures will be
stored in `figs` directory.

## Theoretical (analytical) expressions

There is `theory` directory in the structure of this repository. It stores
Python scripts and CSV files, which can be used to plot analytical results
obtained in [1].

Python scripts encode dependencies between the initial condition and the
mean first passage time for specific values of the independent transition
rate.  Explicit formulas were written down for $\varepsilon=0$, $0.5$, $1$,
$1.5$, $2$ and $2.5$. General expressions are too complicated and might not
be easy to evaluate numerically.

Dependence between the independent transition rate and the mean first
passage time is notably much more complicated. So, it was evaluated using
Wolfram Engine and the results were stored in CSV files. Note that for
extremely large $\varepsilon$ even Wolfram Engine was not able to produce
consistent curve, so in the figures you'll see the curves being extended
through the asymptotic approximation.

## Dependencies

C code depends on GNU Scientific Library.

Python (3.13) scripts depend on:

* `numpy` (2.2.6)
* `typer` (0.15.2)
* `matplotlib` (3.10.3)
* `os` (standard library)
* `ctypes` (standard library)
* `gc` (standard library)
* `typing` (standard library)

## References

1. R. Kazakevicius, A. Kononovicius. *Mean First Passage Time of the
   Symmetric Noisy Voter Model with Arbitrary Initial and Boundary
   Conditions*. (draft).
